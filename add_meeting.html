<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Meeter - portal dla wszystkich oprócz Amerykanów</title>
        <script src="add_human.js" defer></script>
        <link rel="stylesheet" href="styles.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
    </head>
    <body>
        <div class="container">
            <nav class="left-menu">
                
            </nav>
            <main class="content" id="main_content">
                <form action="javascript:;" onsubmit=" addMeeting( this ) " enctype="multipart/form-data">
                    <fieldset>
                        <h3>Miejsce spotkania</h3><br>
                        <input type="text" id="meetingPlaceInputField" placeholder="Miejsce spotkania">
                        <h3>Data</h3>
                        <input type="date" id="meetingDateInputField"></br></br>
                        <input type="submit" value="Dodaj spotkanie!"></br></br>
                    </fieldset>
                </form>
            </main>
            <aside class="right-menu">
                <!-- Right menu content goes here -->
            </aside>
        </div>
        <script>
            function createLeftMenu() {
                const menuButtonsArray = [{"id":"mainPage","text": "Strona główna", "onclick": "showMainPage()"}, {"id":"addNewHuman","href": "add_human.html", "text": "Dodaj nowego człowieka"}, {"id": "calendar","onclick": "makeCalendar()", "text": "Zobacz kalendarz"}, {"id": "showAllCliques","onclick": "menuShowAllCliques()", "text": "Pokaż wszystkie kliki"}, {"id": "showAllPeople","onclick": "getPeople()", "text": "Zobacz wszystkich ludzi"}, {"id": "addNewMeeting", "href": "add_meeting.html", "text": "Dodaj nowe spotanie"}, {"id": "addNewClique", "href": "add_new_clique.html", "text": "Dodaj nową klikę"}, {"id": "addHumansToMeeting", "text": "Dodaj ludzi do spotkania", "href": "add_humans_to_meeting.html"}]
                //póki co testuję to na prawym menu, stąd ten mindfuck
                let leftMenu = document.getElementsByClassName("left-menu")[0]
                leftMenu.innerHTML = ""
                for (singleButton of menuButtonsArray) {
                    const idOfDIv = singleButton.id
                    const textOfDiv = singleButton.text
                    let newCreatedButton = document.createElement("div")
                    newCreatedButton.setAttribute("id", idOfDIv)
                    newCreatedButton.innerText = textOfDiv
                    newCreatedButton.setAttribute("class", "left_option")
                    if (singleButton.hasOwnProperty("onclick")) {
                        newCreatedButton.setAttribute("onclick", singleButton.onclick)
                        leftMenu.appendChild(newCreatedButton)
                    }
                    if (singleButton.hasOwnProperty("href")) {
                        let encapsulatingA = document.createElement("a")
                        encapsulatingA.setAttribute("href", singleButton.href)
                        encapsulatingA.appendChild(newCreatedButton)
                        leftMenu.appendChild(encapsulatingA)
                        newCreatedButton.setAttribute("href", singleButton.href)
                    }
                }

            }
            createLeftMenu()
            function clearMainContent() {
                let mainContentDiv = document.getElementById("main_content")
                mainContentDiv.innerHTML = ""
            }
            async function addMeeting() {
                const dateOfMeeting = document.getElementById("meetingDateInputField").value
                const placeOfMeeting = document.getElementById("meetingPlaceInputField").value
                const addedMeetingRequest = await fetch(`http://localhost:3000/add_meeting?date=${dateOfMeeting}&place=${placeOfMeeting}`, {method: "POST"})
                if (addedMeetingRequest.status == 200) {
                    console.log(`Udało się dodać spotkanie dnia ${dateOfMeeting} w ${placeOfMeeting}.`)
                    const idOfAddedMeeting = await fetch(`http://localhost:3000/meeting_id_from_date_and_place?place=${placeOfMeeting}&date=${dateOfMeeting}`)
                    const encapsulatedIdOfMeeting = await idOfAddedMeeting.json()
                    console.log(encapsulatedIdOfMeeting)
                    console.log(`Dodanemu spotkaniu zostało nadane ID ${encapsulatedIdOfMeeting[0]["ID"]}.`)
                }
                else {
                    alert("Z jakiegoś powodu nie udało się zapisać danych.")
                }
            }
        </script>
    </body>
</html>