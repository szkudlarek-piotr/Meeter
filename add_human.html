<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Meeter - portal dla wszystkich oprócz Amerykanów</title>
        <script src="add_human.js" defer></script>
        <link rel="stylesheet" href="styles.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
    </head>
    <body>
        <div class="container">
            <nav class="left-menu">
                <div class="left_option" id="mainPage">
                    Strona główna
                </div>
                <div class="left_option" id="addNewHuman" onclick="menuAddNewHuman()">
                    Dodaj nowego człowieka
                </div>
                <div class="left_option" id="addNewMeeting" onclick="menuAddNewMeeting()">
                    Dodaj nowe spotkanie
                </div>
                <div class="left_option" id="addNewClique" onclick="menuAddNewClique()">
                    Dodaj nową klikę
                </div>
                <div class="left_option" id="showAllPeople" onclick="getPeople()">
                    Zobacz wszystkich ludzi
                </div>
                <div class="left_option" id="showAllCliques"onclick="menuShowAllCliques()">
                    Zobacz wszystkie kliki
                </div>
                <div class="left_option" id="calendar"onclick="makeCalendar()">
                    Zobacz kalendarz!
                </div>
            </nav>
            <main class="content" id="main_content">
                <form action="javascript:;" onsubmit=" addHuman( this ) " enctype="multipart/form-data">
                    <fieldset>
                        <h3>Imię</h3>
                        <input type="text" id="nameInputField" placeholder="Imię">
                        <h3>Nazwisko</h3>
                        <input type="text" id="surnameInputField" placeholder="Nazwisko">
                        <h3>Płeć</h3>
                        <div><label><input type="radio" name="gender" value="M">Mężczyzna</label></div><br>
                        <div><label><input type="radio" name="gender" value="F">Kobieta</label></div>
                        <h3>Klika</h3>
                        <div id="cliqueInputDiv">
                            <input type="text" id="cliqueInputField" onkeyup="getSuggestedCliques()" placeholder="Skąd znasz?">
                            <div id="cliqueSuggestionsContainer"></div>
                        </div>
                        <h3>Mieszka w...</h3>
                        <input type="text" id="cityInputField" placeholder="Miasto">
                        <h3>Link do Facbooka</h3>
                        <input type="text" id="fbInputField" placeholder="Wklej link do FB">
                        <h3>Dodaj zdjęcie:</h3>
                        <input type="file" name="humanPhotoInput"/><br><br><br>
                        <input type="submit" value="Dodaj!">
                    </fieldset>
                </form>
            </main>
            <aside class="right-menu">
                <!-- Right menu content goes here -->
            </aside>
        </div>
        <script>
            function clearSuggestionsDiv() {
                let suggestionsContainer =  document.getElementById("cliqueSuggestionsContainer")
                suggestionsContainer.innerHTML = ""
            }

            function createLeftMenu() {
                const menuButtonsArray = [{"id":"mainPage","text": "Strona główna", "onclick": "showMainPage()"}, {"id":"addNewHuman","href": "add_human.html", "text": "Dodaj nowego człowieka"}, {"id": "calendar","onclick": "makeCalendar()", "text": "Zobacz kalendarz"}, {"id": "showAllCliques","onclick": "menuShowAllCliques()", "text": "Pokaż wszystkie kliki"}, {"id": "showAllPeople","onclick": "getPeople()", "text": "Zobacz wszystkich ludzi"}, {"id": "addNewMeeting", "href": "add_meeting.html", "text": "Dodaj nowe spotanie"}, {"id": "addNewClique", "href": "add_new_clique.html", "text": "Dodaj nową klikę"}]
                let leftMenu = document.getElementsByClassName("right-menu")[0]
                leftMenu.innerHTML = ""
                for (singleButton of menuButtonsArray) {
                    const idOfDIv = singleButton.id
                    const textOfDiv = singleButton.text
                    let newCreatedButton = document.createElement("div")
                    newCreatedButton.setAttribute("id", idOfDIv)
                    newCreatedButton.innerText = textOfDiv
                    newCreatedButton.setAttribute("class", "left_option")
                    if (singleButton.hasOwnProperty("onclick")) {
                        newCreatedButton.setAttribute("onclick", singleButton.onclick)
                        leftMenu.appendChild(newCreatedButton)
                    }
                    if (singleButton.hasOwnProperty("href")) {
                        let encapsulatingA = document.createElement("a")
                        encapsulatingA.setAttribute("href", singleButton.href)
                        encapsulatingA.appendChild(newCreatedButton)
                        leftMenu.appendChild(encapsulatingA)
                        newCreatedButton.setAttribute("href", singleButton.href)
                    }
                }

            }
            createLeftMenu()
            function clearMainContent() {
                let mainContentDiv = document.getElementById("main_content")
                mainContentDiv.innerHTML = ""
            }
            async function addHuman() {
                const nameToSend = document.getElementById("nameInputField").value
                const surnameToSend = document.getElementById("surnameInputField").value
                const cityToSend = document.getElementById("cityInputField").value
                const fbLinkToSend = document.getElementById("fbInputField").value
                const cliqueNumber = document.getElementById("cliqueInputField").value
                const gender = document.querySelector('input[name="gender"]:checked').value
                let jsonToSend = {}
                jsonToSend["name"] = nameToSend
                jsonToSend["surnname"] = surnameToSend
                jsonToSend["city"] = cityToSend
                jsonToSend["fb"] = fbLinkToSend
                jsonToSend["clique"] = cliqueNumber
                jsonToSend["gender"] = gender
                const insertRequest = await fetch(`http://localhost:3000/add_human?name=${nameToSend}&surname=${surnameToSend}&city=${cityToSend}&fb=${fbLinkToSend}&clique=${cliqueNumber}&gender=${gender}`, {method: "POST"})
                const idOfAddedHuman = await fetch(`http://localhost:3000/get_id?name=${nameToSend}&surname=${surnameToSend}&fb_link=${fbLinkToSend}`)
                const obtainedData = await idOfAddedHuman.json()
                alert(`Spróbowałem dodać osob o personaliach ${nameToSend} ${surnameToSend} do bazy danych.`)
                console.log(obtainedData[0]["ID"])
                document.getElementById("nameInputField").value = ""
                document.getElementById("surnameInputField").value = ""
                document.getElementById("cityInputField").value = ""
                document.getElementById("fbInputField").value = ""
                document.getElementById("cliqueInputField").value = ""
            }
            function suggestCliques() {
                const currentValue = document.getElementById("cliqueInputField").value
            }

        </script>
    </body>
</html>